Another Ensemble of Ensemble of Ensemble
Credits to books taken as input, Upvote and Comment any suggestion
In [1]:
# This Python 3 environment comes with many helpful analytics libraries installed
# It is defined by the kaggle/python Docker image: https://github.com/kaggle/docker-python
# For example, here's several helpful packages to load

import numpy as np # linear algebra
import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)

# Input data files are available in the read-only "../input/" directory
# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory

import os
for dirname, _, filenames in os.walk('/kaggle/input'):
    for filename in filenames:
        print(os.path.join(dirname, filename))

# You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using "Save & Run All" 
# You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session
/kaggle/input/ensemble-of-only-three-diverse-models-podcast/__results__.html
/kaggle/input/ensemble-of-only-three-diverse-models-podcast/submission.csv
/kaggle/input/ensemble-of-only-three-diverse-models-podcast/__notebook__.ipynb
/kaggle/input/ensemble-of-only-three-diverse-models-podcast/__output__.json
/kaggle/input/ensemble-of-only-three-diverse-models-podcast/custom.css
/kaggle/input/single-xgboost-add-selected-features/oof_pred_2+3+4_interact_xgb.pkl
/kaggle/input/single-xgboost-add-selected-features/__results__.html
/kaggle/input/single-xgboost-add-selected-features/submission.csv
/kaggle/input/single-xgboost-add-selected-features/__notebook__.ipynb
/kaggle/input/single-xgboost-add-selected-features/__output__.json
/kaggle/input/single-xgboost-add-selected-features/custom.css
/kaggle/input/single-xgboost-add-selected-features/__results___files/__results___17_0.png
/kaggle/input/single-xgboost-add-selected-features/__results___files/__results___17_3.png
/kaggle/input/single-xgboost-add-selected-features/__results___files/__results___17_4.png
/kaggle/input/single-xgboost-add-selected-features/__results___files/__results___17_2.png
/kaggle/input/single-xgboost-add-selected-features/__results___files/__results___17_1.png
/kaggle/input/ps-s5-e4-ensemble-of-solutions/subm_26gs.csv
/kaggle/input/ps-s5-e4-ensemble-of-solutions/subm_32hs.csv
/kaggle/input/ps-s5-e4-ensemble-of-solutions/__results__.html
/kaggle/input/ps-s5-e4-ensemble-of-solutions/submission.csv
/kaggle/input/ps-s5-e4-ensemble-of-solutions/__notebook__.ipynb
/kaggle/input/ps-s5-e4-ensemble-of-solutions/__output__.json
/kaggle/input/ps-s5-e4-ensemble-of-solutions/subm_5ths.csv
/kaggle/input/ps-s5-e4-ensemble-of-solutions/custom.css
/kaggle/input/11-83504-ensemble-prediction-of-listening-time/__results__.html
/kaggle/input/11-83504-ensemble-prediction-of-listening-time/submission.csv
/kaggle/input/11-83504-ensemble-prediction-of-listening-time/__notebook__.ipynb
/kaggle/input/11-83504-ensemble-prediction-of-listening-time/__output__.json
/kaggle/input/11-83504-ensemble-prediction-of-listening-time/custom.css
/kaggle/input/xgboost-single-model/__results__.html
/kaggle/input/xgboost-single-model/submission.csv
/kaggle/input/xgboost-single-model/__notebook__.ipynb
/kaggle/input/xgboost-single-model/__output__.json
/kaggle/input/xgboost-single-model/custom.css
/kaggle/input/say-goodbye-to-ordinalencoder/__results__.html
/kaggle/input/say-goodbye-to-ordinalencoder/submission.csv
/kaggle/input/say-goodbye-to-ordinalencoder/__notebook__.ipynb
/kaggle/input/say-goodbye-to-ordinalencoder/__output__.json
/kaggle/input/say-goodbye-to-ordinalencoder/custom.css
/kaggle/input/ps-s5-e4-division-attention/Datt_1.csv
/kaggle/input/ps-s5-e4-division-attention/subm_26g.csv
/kaggle/input/ps-s5-e4-division-attention/__results__.html
/kaggle/input/ps-s5-e4-division-attention/subm_5th.csv
/kaggle/input/ps-s5-e4-division-attention/submission.csv
/kaggle/input/ps-s5-e4-division-attention/Datt_2.csv
/kaggle/input/ps-s5-e4-division-attention/__notebook__.ipynb
/kaggle/input/ps-s5-e4-division-attention/__output__.json
/kaggle/input/ps-s5-e4-division-attention/subm_32h.csv
/kaggle/input/ps-s5-e4-division-attention/custom.css
/kaggle/input/predict-podcast-listening-time-ensemble-t-rk-e/subm_13f.csv
/kaggle/input/predict-podcast-listening-time-ensemble-t-rk-e/__results__.html
/kaggle/input/predict-podcast-listening-time-ensemble-t-rk-e/subm_26e.csv
/kaggle/input/predict-podcast-listening-time-ensemble-t-rk-e/subm_5i.csv
/kaggle/input/predict-podcast-listening-time-ensemble-t-rk-e/submission.csv
/kaggle/input/predict-podcast-listening-time-ensemble-t-rk-e/Datt_1_ascending.csv
/kaggle/input/predict-podcast-listening-time-ensemble-t-rk-e/subm_13d.csv
/kaggle/input/predict-podcast-listening-time-ensemble-t-rk-e/__notebook__.ipynb
/kaggle/input/predict-podcast-listening-time-ensemble-t-rk-e/__output__.json
/kaggle/input/predict-podcast-listening-time-ensemble-t-rk-e/Datt_2_descending.csv
/kaggle/input/predict-podcast-listening-time-ensemble-t-rk-e/subm_5l.csv
/kaggle/input/predict-podcast-listening-time-ensemble-t-rk-e/custom.css
/kaggle/input/podcast-nn-ydf-cat-xgb-lgbm-hgb/__results__.html
/kaggle/input/podcast-nn-ydf-cat-xgb-lgbm-hgb/submission.csv
/kaggle/input/podcast-nn-ydf-cat-xgb-lgbm-hgb/__notebook__.ipynb
/kaggle/input/podcast-nn-ydf-cat-xgb-lgbm-hgb/__output__.json
/kaggle/input/podcast-nn-ydf-cat-xgb-lgbm-hgb/custom.css
/kaggle/input/podcast-nn-ydf-cat-xgb-lgbm-hgb/__results___files/__results___7_19.png
/kaggle/input/podcast-nn-ydf-cat-xgb-lgbm-hgb/__results___files/__results___7_22.png
/kaggle/input/podcast-nn-ydf-cat-xgb-lgbm-hgb/__results___files/__results___19_1.png
/kaggle/input/podcast-nn-ydf-cat-xgb-lgbm-hgb/__results___files/__results___7_17.png
/kaggle/input/podcast-nn-ydf-cat-xgb-lgbm-hgb/__results___files/__results___7_20.png
/kaggle/input/podcast-nn-ydf-cat-xgb-lgbm-hgb/__results___files/__results___17_2.png
/kaggle/input/podcast-nn-ydf-cat-xgb-lgbm-hgb/__results___files/__results___17_1.png
/kaggle/input/predicting-podcast-listening-time-ensemble/__results__.html
/kaggle/input/predicting-podcast-listening-time-ensemble/submission.csv
/kaggle/input/predicting-podcast-listening-time-ensemble/__notebook__.ipynb
/kaggle/input/predicting-podcast-listening-time-ensemble/__output__.json
/kaggle/input/predicting-podcast-listening-time-ensemble/custom.css
/kaggle/input/predicting-podcast-listening-time-ensemble/__results___files/__results___15_0.png
/kaggle/input/predicting-podcast-listening-time-ensemble/__results___files/__results___14_1.png
/kaggle/input/predicting-podcast-listening-time-ensemble/__results___files/__results___14_0.png
/kaggle/input/predicting-podcast-listening-time-ensemble/__results___files/__results___15_4.png
/kaggle/input/predicting-podcast-listening-time-ensemble/__results___files/__results___15_2.png
/kaggle/input/predicting-podcast-listening-time-ensemble/__results___files/__results___15_1.png
/kaggle/input/predicting-podcast-listening-time-ensemble/__results___files/__results___15_5.png
/kaggle/input/predicting-podcast-listening-time-ensemble/__results___files/__results___22_1.png
/kaggle/input/predicting-podcast-listening-time-ensemble/__results___files/__results___15_3.png
/kaggle/input/playground-series-s5e4/sample_submission.csv
/kaggle/input/playground-series-s5e4/train.csv
/kaggle/input/playground-series-s5e4/test.csv
In [2]:
import os
import numpy as np
import pandas as pd
In [3]:
targetName = 'Listening_Time_minutes'
competitionDir = '/kaggle/input/podcast-listening-time-prediction'
submission = pd.read_csv('/kaggle/input/playground-series-s5e4/sample_submission.csv')
This script collects and validates prediction data from multiple submission.csv files in Kaggle competition directories.
Key Functionality
Directory Scanning: Recursively searches through /kaggle/input
File Filtering: Only processes:
Files NOT in the main competition directory
Files containing 'submission.csv' in their name
Data Validation: Ensures:
Consistent row count with reference submission
Proper target column existence
Outputs
Variable Content
preds List of prediction columns from valid submissions
fileName List of source directories for each submission
Typical Use Case
Aggregating team submissions in Kaggle competitions
Preparing data for ensemble modeling
Validating submission file consistency
Process Flow
Scan directories → 2. Filter files → 3. Validate structure → 4. Extract predictions
Note: Silently skips files with mismatched formats or missing columns
In [4]:
preds = []
fileName = []
for dirname, _, filenames in os.walk('/kaggle/input'):
    for filename in filenames:
        if (dirname != competitionDir) & ('submission.csv' in filename):
            df = pd.read_csv(os.path.join(dirname, filename))
            fileName.append(dirname)
            if len(df) == len(submission):
                try:
                    preds.append(df[targetName])
                except Exception:
                    pass
In [5]:
print(len(fileName))
for i in fileName:
    print(i)
11
/kaggle/input/ensemble-of-only-three-diverse-models-podcast
/kaggle/input/single-xgboost-add-selected-features
/kaggle/input/ps-s5-e4-ensemble-of-solutions
/kaggle/input/11-83504-ensemble-prediction-of-listening-time
/kaggle/input/xgboost-single-model
/kaggle/input/say-goodbye-to-ordinalencoder
/kaggle/input/ps-s5-e4-division-attention
/kaggle/input/predict-podcast-listening-time-ensemble-t-rk-e
/kaggle/input/podcast-nn-ydf-cat-xgb-lgbm-hgb
/kaggle/input/predicting-podcast-listening-time-ensemble
/kaggle/input/playground-series-s5e4
Weighted Model Ensemble Implementation
Overview
Ensemble by combining multiple submissions with calibrated weights
Ensemble Weighting Code
Step Code Explanation
1. Define weights weights = [0.075, 0.075, 0.05, 0.05, 0.05, 0.02, 0.03, 0.05, 0.20, 0.20, 0.20] Assigns importance to each prediction model
2. Convert predictions preds_array = np.array(preds) Transforms predictions into NumPy array format
3. Calculate weighted average weighted_predictions = np.average(preds_array, axis=0, weights=weights) Computes final predictions giving more influence to models with higher weights
4. Update and save submission[targetName] = weighted_predictions
submission.to_csv("submission.csv", index=False) Stores results in a DataFrame and saves to CSV file
In [6]:
# weights = [0.10,0.03,0.12,0.40,0.20,0.20,0.001]  
# weights = [0.25,0.25,0.22,0.28]  
# weights = [0.075,0.075,0.05,0.05,0.05,0.02,0.03,0.05,0.20,0.20,0.20]  (some notebooks became private)
weights = [0.04,0.33,0.02,0.05,0.03,0.16,0.10,0.01,0.05,0.17,0.04]  


# Convert `preds` to a NumPy array
preds_array = np.array(preds)

# Compute weighted sum
weighted_predictions = np.average(preds_array, axis=0, weights=weights)

# Update submission DataFrame
submission[targetName] = weighted_predictions
submission.to_csv("submission.csv", index=False)
Some arrays related OCD (need to print to confirm)
In [7]:
print(preds_array.shape)
(11, 250000)
In [8]:
submission[targetName] = np.array(preds).mean(axis=0).transpose()
# submission.to_csv("submission.csv", index=False)
# Model/Ensemble Type Score
1 Single XGBoost with selected features 0.850
2 Ensemble of only three diverse models 0.840
3 PS S5 E4 Ensemble of solutions 0.827
4 Predicting podcast listening time ensemble 0.82625
5 11-83504 Ensemble prediction 0.82624
6 PS S5 E4 Division attention 0.825
In [9]:
df_podcast_nn_ydf_cat_xgb_lgbm_hgb = pd.read_csv("/kaggle/input/podcast-nn-ydf-cat-xgb-lgbm-hgb/submission.csv")
df_ps_s5_e4_ensemble_of_solutions = pd.read_csv("/kaggle/input/ps-s5-e4-ensemble-of-solutions/submission.csv")
df_11_83504_ensemble_prediction_of_listening_time = pd.read_csv("/kaggle/input/11-83504-ensemble-prediction-of-listening-time/submission.csv")
df_predicting_podcast_listening_time_ensemble = pd.read_csv("/kaggle/input/predicting-podcast-listening-time-ensemble/submission.csv")
df_ensemble_of_only_three_diverse_models_podcast = pd.read_csv("/kaggle/input/ensemble-of-only-three-diverse-models-podcast/submission.csv")
sub_datten = pd.read_csv("/kaggle/input/ps-s5-e4-division-attention/submission.csv")
sub_singlexgb = pd.read_csv("/kaggle/input/xgboost-single-model/submission.csv")

sample_submission = pd.read_csv("/kaggle/input/playground-series-s5e4/sample_submission.csv")


sample_submission['Listening_Time_minutes'] = (
    0.30 * sub_singlexgb['Listening_Time_minutes'] +
    0.10 * df_podcast_nn_ydf_cat_xgb_lgbm_hgb['Listening_Time_minutes'] +
    0.20 * df_ps_s5_e4_ensemble_of_solutions['Listening_Time_minutes'] +
    0.06 * df_predicting_podcast_listening_time_ensemble['Listening_Time_minutes'] +
    0.04 * df_11_83504_ensemble_prediction_of_listening_time['Listening_Time_minutes'] +
    0.20 * df_ensemble_of_only_three_diverse_models_podcast['Listening_Time_minutes'] +
    0.09 * sub_datten['Listening_Time_minutes']+
    0.01 * submission[targetName]  

    
)

sample_submission.to_csv('submission.csv', index=False)
sample_submission.head()
Out[9]:
id Listening_Time_minutes
0 750000 54.495923
1 750001 23.554614
2 750002 48.327816
3 750003 81.163097
4 750004 50.469338
In [ ]: