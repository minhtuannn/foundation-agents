In [1]:
import warnings
warnings.filterwarnings('ignore')
import numpy as np 
import pandas as pd 
import matplotlib.pyplot as plt
import seaborn as sns
> Overview of the Data
In [2]:
train_df = pd.read_csv("/kaggle/input/playground-series-s5e6/train.csv")
In [3]:
print(f"Dataset Shape: {train_df.shape}")

print("\nData Info:")
train_df.info()

print("\nNumerical Features Summary:")
display(train_df.describe())

print("\nFirst 10 Rows of the Dataset:")
display(train_df.head(10))
Dataset Shape: (750000, 10)

Data Info:
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 750000 entries, 0 to 749999
Data columns (total 10 columns):
 #   Column           Non-Null Count   Dtype 
---  ------           --------------   ----- 
 0   id               750000 non-null  int64 
 1   Temparature      750000 non-null  int64 
 2   Humidity         750000 non-null  int64 
 3   Moisture         750000 non-null  int64 
 4   Soil Type        750000 non-null  object
 5   Crop Type        750000 non-null  object
 6   Nitrogen         750000 non-null  int64 
 7   Potassium        750000 non-null  int64 
 8   Phosphorous      750000 non-null  int64 
 9   Fertilizer Name  750000 non-null  object
dtypes: int64(7), object(3)
memory usage: 57.2+ MB

Numerical Features Summary:
id Temparature Humidity Moisture Nitrogen Potassium Phosphorous
count 750000.000000 750000.000000 750000.000000 750000.000000 750000.000000 750000.000000 750000.000000
mean 374999.500000 31.503565 61.038912 45.184147 23.093808 9.478296 21.073227
std 216506.495284 4.025574 6.647695 11.794594 11.216125 5.765622 12.346831
min 0.000000 25.000000 50.000000 25.000000 4.000000 0.000000 0.000000
25% 187499.750000 28.000000 55.000000 35.000000 13.000000 4.000000 10.000000
50% 374999.500000 32.000000 61.000000 45.000000 23.000000 9.000000 21.000000
75% 562499.250000 35.000000 67.000000 55.000000 33.000000 14.000000 32.000000
max 749999.000000 38.000000 72.000000 65.000000 42.000000 19.000000 42.000000
First 10 Rows of the Dataset:
id Temparature Humidity Moisture Soil Type Crop Type Nitrogen Potassium Phosphorous Fertilizer Name
0 0 37 70 36 Clayey Sugarcane 36 4 5 28-28
1 1 27 69 65 Sandy Millets 30 6 18 28-28
2 2 29 63 32 Sandy Millets 24 12 16 17-17-17
3 3 35 62 54 Sandy Barley 39 12 4 10-26-26
4 4 35 58 43 Red Paddy 37 2 16 DAP
5 5 30 59 29 Red Pulses 10 0 9 20-20
6 6 27 62 53 Sandy Paddy 26 15 22 28-28
7 7 36 62 44 Red Pulses 30 12 35 14-35-14
8 8 36 51 32 Loamy Tobacco 19 17 29 17-17-17
9 9 28 50 35 Red Tobacco 25 12 16 20-20
Univariate Analysis
Numerical Features
In [4]:
numerical_features = [
    "Temparature",
    "Humidity",
    "Moisture",
    "Nitrogen",
    "Potassium",
    "Phosphorous", 
]

for feature in numerical_features:
    plt.figure(figsize=(12, 5))

    plt.subplot(1, 2, 1)
    sns.histplot(train_df[feature], kde=True, bins=30)
    plt.title(f"Histogram of {feature}")
    plt.xlabel(feature)
    plt.ylabel("Frequency")

    plt.subplot(1, 2, 2)
    sns.boxplot(x=train_df[feature])
    plt.title(f"Box Plot of {feature}")

    plt.tight_layout()
    plt.show()

    print(f"\nStatistics for {feature}:")
    print(f"Skewness: {train_df[feature].skew():.2f}")
    print(f"Number of Missing Values: {train_df[feature].isnull().sum()}")
Statistics for Temparature:
Skewness: -0.00
Number of Missing Values: 0
Statistics for Humidity:
Skewness: -0.01
Number of Missing Values: 0
Statistics for Moisture:
Skewness: -0.02
Number of Missing Values: 0
Statistics for Nitrogen:
Skewness: -0.01
Number of Missing Values: 0
Statistics for Potassium:
Skewness: -0.00
Number of Missing Values: 0
Statistics for Phosphorous:
Skewness: -0.01
Number of Missing Values: 0
Categorical Features
In [5]:
for feature in ["Soil Type", "Crop Type"]:
    counts = train_df[feature].value_counts()

    # Plot pie chart
    plt.figure(figsize=(6, 6))
    plt.pie(counts, labels=counts.index, autopct='%1.1f%%', startangle=90)
    plt.title(f"Distribution of {feature}")
    plt.axis("equal")
    plt.show()

    # Print unique and missing values
    print(f"Number of Unique {feature}: {train_df[feature].nunique()}")
    print(f"Missing Values in {feature}: {train_df[feature].isnull().sum()}")
Number of Unique Soil Type: 5
Missing Values in Soil Type: 0
Number of Unique Crop Type: 11
Missing Values in Crop Type: 0
KDE plot
In [6]:
colors = sns.color_palette('husl', len(numerical_features))

rows = -(-len(numerical_features) // 4)
plt.figure(figsize=(20, 5 * rows))

for i, (col, color) in enumerate(zip(numerical_features, colors), 1):
    plt.subplot(rows, 4, i)
    sns.kdeplot(data=train_df, x=col, fill=True, color=color)
    plt.title(f'KDE Plot of {col}', fontsize=14, color=color)
    plt.xlabel(col)
    plt.ylabel('Density')

plt.tight_layout()
plt.show()
Scatter plot
In [7]:
numeric_df = train_df.select_dtypes(include='number')

sns.pairplot(numeric_df, corner=True, plot_kws={'alpha': 0.5})
plt.suptitle('Pairwise Scatter Plots', y=1.02)
plt.show()
Bivariate Analysis
Numerical Features vs Label
In [8]:
for feature in numerical_features[:-1]:  
    plt.figure(figsize=(8, 6))
    sns.scatterplot(
        x=train_df[feature], y=train_df["Fertilizer Name"], alpha=0.5
    )
    plt.title(f"{feature} vs. Fertilizer Name")
    plt.xlabel(feature)
    plt.ylabel("Fertilizer Name")
    plt.show()

correlation_matrix = train_df[numerical_features].corr()
plt.figure(figsize=(10, 8))
sns.heatmap(correlation_matrix, annot=True, cmap="coolwarm", fmt=".2f")
plt.title("Correlation Matrix of Numerical Features")
plt.show()
Categorical Features vs Label
In [9]:
plt.figure(figsize=(12, 6))
sns.countplot(x="Soil Type", hue="Fertilizer Name", data=train_df)
plt.title("Distribution of Fertilizer Name across Soil Types")
plt.xlabel("Soil Type")
plt.ylabel("Count")
plt.xticks(rotation=45)
plt.legend(title="Fertilizer Name", bbox_to_anchor=(1.05, 1), loc='upper left')
plt.tight_layout()
plt.show()
In [10]:
import seaborn as sns
import pandas as pd

cross_tab = pd.crosstab(train_df["Soil Type"], train_df["Fertilizer Name"])

plt.figure(figsize=(12, 6))
sns.heatmap(cross_tab, annot=True, fmt="d", cmap="YlGnBu")
plt.title("Soil Type vs. Fertilizer Name (Counts)")
plt.ylabel("Soil Type")
plt.xlabel("Fertilizer Name")
plt.xticks(rotation=45)
plt.yticks(rotation=0)
plt.tight_layout()
plt.show()
In [11]:
plt.figure(figsize=(12, 6))
sns.countplot(x="Crop Type", hue="Fertilizer Name", data=train_df)
plt.title("Distribution of Fertilizer Name across Crop Types")
plt.xlabel("Crop Type")
plt.ylabel("Count")
plt.xticks(rotation=45)
plt.legend(title="Fertilizer Name", bbox_to_anchor=(1.05, 1), loc='upper left')
plt.tight_layout()
plt.show()
In [12]:
cross_tab = pd.crosstab(train_df["Crop Type"], train_df["Fertilizer Name"])

plt.figure(figsize=(12, 6))
sns.heatmap(cross_tab, annot=True, fmt="d", cmap="YlGnBu")
plt.title("Crop Type vs. Fertilizer Name (Counts)")
plt.ylabel("Crop Type")
plt.xlabel("Fertilizer Name")
plt.xticks(rotation=45)
plt.yticks(rotation=0)
plt.tight_layout()
plt.show()
Trend plot
In [13]:
colors = sns.color_palette('husl', len(numerical_features))

rows = -(-len(numerical_features) // 4)
plt.figure(figsize=(20, 5 * rows))

for i, (col, color) in enumerate(zip(numerical_features, colors), 1):
    plt.subplot(rows, 4, i)
    sns.lineplot(data=train_df[col], color=color)
    plt.title(f'Trend Plot of {col}', fontsize=14, color=color)
    plt.xlabel('Index')
    plt.ylabel(col)

plt.tight_layout()
plt.show()
Kde+Trend
In [14]:
colors = sns.color_palette('husl', len(numerical_features))
rows = -(-len(numerical_features) // 4)
plt.figure(figsize=(20, 5 * rows))

for i, (col, color) in enumerate(zip(numerical_features, colors), 1):
    plt.subplot(rows, 4, i)
    sns.kdeplot(data=train_df, x=col, fill=True, color=color)
    sns.lineplot(data=train_df[col].sort_values().reset_index(drop=True), color='black', linewidth=1)
    plt.title(f'KDE + Trend of {col}', fontsize=14, color=color)
    plt.xlabel(col)
    plt.ylabel('Density')

plt.tight_layout()
plt.show()
Violin Plot
In [15]:
colors = sns.color_palette('husl', len(numerical_features))
rows = -(-len(numerical_features) // 4)
plt.figure(figsize=(20, 5 * rows))

for i, (col, color) in enumerate(zip(numerical_features, colors), 1):
    plt.subplot(rows, 4, i)
    sns.violinplot(data=train_df, y=col, color=color)
    plt.title(f'Violin Plot of {col}', fontsize=14, color=color)
    plt.xlabel('')
    plt.ylabel(col)

plt.tight_layout()
plt.show()
Thanks for visiting. If you find any useful insights, please consider upvoting!